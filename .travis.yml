language: node_js
node_js:
- stable
cache:
  directories:
  - node_modules
install:
- npm install
services:
- postgresql
before_script:
- psql -c 'create database express_javascript;' -U postgres
- psql -c "CREATE USER root WITH PASSWORD null;" -U postgres
- npm run build
- npm install -g sequelize-cli
- sequelize db:migrate
script:
- npm run test
after_success:
- npm run generate-lcov
- npm run coveralls-coverage
deploy:
  provider: heroku
  api_key:
    secure: $API_KEY
  app: "nodejs-express-postgre-sequliz"
  on:
    repo: vaughan189/nodejs-express-postgresql-sequelize-template
  skip_cleanup: true
